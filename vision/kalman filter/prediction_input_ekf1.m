function [F,V_t,f] = prediction_input(nu_t_1,u_t,n,dt)
x = nu_t_1(4:6);

b1 = nu_t_1(7);
b2 = nu_t_1(8);
b3 = nu_t_1(9);
p1 = u_t(1);
p2 = u_t(2);
p3 = u_t(3);
q1 = u_t(4);
q2 = u_t(5);
q3 = u_t(6);
ng1 = n(4);
ng2 = n(5);
ng3 = n(6);
F = zeros(9,9);
V_t =zeros(9,9);
nv1 = n(1);
nv2 = n(2);
nv3 = n(3);
nbg1 = n(7);
nbg2 = n(8);
nbg3 = n(9);
f = zeros(1,9);
f = [ p1 - nv1, p2 - nv2, p3 - nv3, - (cos((x(2)))*(b1 + ng1 - q1))/(cos((x(2)))^2 + sin((x(2)))^2) - (sin((x(2)))*(b3 + ng3 - q3))/(cos((x(2)))^2 + sin((x(2)))^2), q2 - ng2 - b2 + (cos((x(2)))*sin((x(1)))*(b3 + ng3 - q3))/(cos((x(1)))*cos((x(2)))^2 + cos((x(1)))*sin((x(2)))^2) - (sin((x(1)))*sin((x(2)))*(b1 + ng1 - q1))/(cos((x(1)))*cos((x(2)))^2 + cos((x(1)))*sin((x(2)))^2), (sin((x(2)))*(b1 + ng1 - q1))/(cos((x(1)))*cos((x(2)))^2 + cos((x(1)))*sin((x(2)))^2) - (cos((x(2)))*(b3 + ng3 - q3))/(cos((x(1)))*cos((x(2)))^2 + cos((x(1)))*sin((x(2)))^2), nbg1, nbg2, nbg3];

F(1,:) = [ 1, 0, 0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      0,                                                                                                                                                                                                                                      0, 0,                                                                                                 0,   0,                                                                                                0];
F(2,:) = [ 0, 1, 0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      0,                                                                                                                                                                                                                                      0, 0,                                                                                                 0,   0,                                                                                                0];
F(3,:) = [ 0, 0, 1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      0,                                                                                                                                                                                                                                      0, 0,                                                                                                 0,   0,                                                                                                0];
F(4,:) = [ 0, 0, 0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      1,                                                                                        -dt*((cos((x(2)))*(b3 + ng3 - q3))/(cos((x(2)))^2 + sin((x(2)))^2) - (sin((x(2)))*(b1 + ng1 - q1))/(cos((x(2)))^2 + sin((x(2)))^2)), 0,                                           -(dt*cos((x(2))))/(cos((x(2)))^2 + sin((x(2)))^2),   0,                                          -(dt*sin((x(2))))/(cos((x(2)))^2 + sin((x(2)))^2)];
F(5,:) = [ 0, 0, 0, dt*((cos((x(1)))*cos((x(2)))*(b3 + ng3 - q3))/(cos((x(1)))*cos((x(2)))^2 + cos((x(1)))*sin((x(2)))^2) - (cos((x(1)))*sin((x(2)))*(b1 + ng1 - q1))/(cos((x(1)))*cos((x(2)))^2 + cos((x(1)))*sin((x(2)))^2) + (cos((x(2)))*sin((x(1)))*(sin((x(1)))*cos((x(2)))^2 + sin((x(1)))*sin((x(2)))^2)*(b3 + ng3 - q3))/(cos((x(1)))*cos((x(2)))^2 + cos((x(1)))*sin((x(2)))^2)^2 - (sin((x(1)))*sin((x(2)))*(sin((x(1)))*cos((x(2)))^2 + sin((x(1)))*sin((x(2)))^2)*(b1 + ng1 - q1))/(cos((x(1)))*cos((x(2)))^2 + cos((x(1)))*sin((x(2)))^2)^2), 1 - dt*((cos((x(2)))*sin((x(1)))*(b1 + ng1 - q1))/(cos((x(1)))*cos((x(2)))^2 + cos((x(1)))*sin((x(2)))^2) + (sin((x(1)))*sin((x(2)))*(b3 + ng3 - q3))/(cos((x(1)))*cos((x(2)))^2 + cos((x(1)))*sin((x(2)))^2)), 0, -(dt*sin((x(1)))*sin((x(2))))/(cos((x(1)))*cos((x(2)))^2 + cos((x(1)))*sin((x(2)))^2), -dt, (dt*cos((x(2)))*sin((x(1))))/(cos((x(1)))*cos((x(2)))^2 + cos((x(1)))*sin((x(2)))^2)];
F(6,:) = [ 0, 0, 0,                                                                                                                                                                                                                                                            -dt*((cos((x(2)))*(sin((x(1)))*cos((x(2)))^2 + sin((x(1)))*sin((x(2)))^2)*(b3 + ng3 - q3))/(cos((x(1)))*cos((x(2)))^2 + cos((x(1)))*sin((x(2)))^2)^2 - (sin((x(2)))*(sin((x(1)))*cos((x(2)))^2 + sin((x(1)))*sin((x(2)))^2)*(b1 + ng1 - q1))/(cos((x(1)))*cos((x(2)))^2 + cos((x(1)))*sin((x(2)))^2)^2),                                 dt*((cos((x(2)))*(b1 + ng1 - q1))/(cos((x(1)))*cos((x(2)))^2 + cos((x(1)))*sin((x(2)))^2) + (sin((x(2)))*(b3 + ng3 - q3))/(cos((x(1)))*cos((x(2)))^2 + cos((x(1)))*sin((x(2)))^2)), 1,                (dt*sin((x(2))))/(cos((x(1)))*cos((x(2)))^2 + cos((x(1)))*sin((x(2)))^2),   0,              -(dt*cos((x(2))))/(cos((x(1)))*cos((x(2)))^2 + cos((x(1)))*sin((x(2)))^2)];
F(7,:) = [ 0, 0, 0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      0,                                                                                                                                                                                                                                      0, 0,                                                                                                 1,   0,                                                                                                0];
F(8,:) = [ 0, 0, 0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      0,                                                                                                                                                                                                                                      0, 0,                                                                                                 0,   1,                                                                                                0];
F(9,:) = [ 0, 0, 0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      0,                                                                                                                                                                                                                                      0, 0,                                                                                                 0,   0,                                                                                                1];

V_t(1,:) = [ -dt,   0,   0,                                                                                                 0,   0,                                                                                                0,  0,  0,  0];
V_t(2,:) = [   0, -dt,   0,                                                                                                 0,   0,                                                                                                0,  0,  0,  0];
V_t(3,:) = [   0,   0, -dt,                                                                                                 0,   0,                                                                                                0,  0,  0,  0];
V_t(4,:) = [   0,   0,   0,                                           -(dt*cos((x(2))))/(cos((x(2)))^2 + sin((x(2)))^2),   0,                                          -(dt*sin((x(2))))/(cos((x(2)))^2 + sin((x(2)))^2),  0,  0,  0];
V_t(5,:) = [   0,   0,   0, -(dt*sin((x(1)))*sin((x(2))))/(cos((x(1)))*cos((x(2)))^2 + cos((x(1)))*sin((x(2)))^2), -dt, (dt*cos((x(2)))*sin((x(1))))/(cos((x(1)))*cos((x(2)))^2 + cos((x(1)))*sin((x(2)))^2),  0,  0,  0];
V_t(6,:) = [   0,   0,   0,                (dt*sin((x(2))))/(cos((x(1)))*cos((x(2)))^2 + cos((x(1)))*sin((x(2)))^2),   0,              -(dt*cos((x(2))))/(cos((x(1)))*cos((x(2)))^2 + cos((x(1)))*sin((x(2)))^2),  0,  0,  0];
V_t(7,:) = [   0,   0,   0,                                                                                                 0,   0,                                                                                                0, dt,  0,  0];
V_t(8,:) = [   0,   0,   0,                                                                                                 0,   0,                                                                                                0,  0, dt,  0];
V_t(9,:) = [   0,   0,   0,                                                                                                 0,   0,                                                                                                0,  0,  0, dt];
