function [F,V_t,f] = prediction_input(nu_t_1,u_t,n,dt)
x = nu_t_1(1:6);
x_vel = nu_t_1(7:9);
bg1 = nu_t_1(10);
bg2 = nu_t_1(11);
bg3 = nu_t_1(12);
ba1 = nu_t_1(13);
ba2 = nu_t_1(14);
ba3 = nu_t_1(15);
p1 = u_t(1);
p2 = u_t(2);
p3 = u_t(3);
q1 = u_t(4);
q2 = u_t(5);
q3 = u_t(6);
ng1 = n(4);
ng2 = n(5);
ng3 = n(6);
na1 = n(1);
na2 = n(2);
na3 = n(3);
F = zeros(15);
V_t =zeros(12);

nbg1 = n(7);
nbg2 = n(8);
nbg3 = n(9);
nba1 = n(10);
nba2 = n(11);
nba3 = n(12);

f = [ x_vel(1), x_vel(2), x_vel(3), - (cos(conj(x(5)))*(bg1 + ng1 - q1))/(cos(conj(x(5)))^2 + sin(conj(x(5)))^2) - (sin(conj(x(5)))*(bg3 + ng3 - q3))/(cos(conj(x(5)))^2 + sin(conj(x(5)))^2), q2 - ng2 - bg2 + (cos(conj(x(5)))*sin(conj(x(4)))*(bg3 + ng3 - q3))/(cos(conj(x(4)))*cos(conj(x(5)))^2 + cos(conj(x(4)))*sin(conj(x(5)))^2) - (sin(conj(x(4)))*sin(conj(x(5)))*(bg1 + ng1 - q1))/(cos(conj(x(4)))*cos(conj(x(5)))^2 + cos(conj(x(4)))*sin(conj(x(5)))^2), (sin(conj(x(5)))*(bg1 + ng1 - q1))/(cos(conj(x(4)))*cos(conj(x(5)))^2 + cos(conj(x(4)))*sin(conj(x(5)))^2) - (cos(conj(x(5)))*(bg3 + ng3 - q3))/(cos(conj(x(4)))*cos(conj(x(5)))^2 + cos(conj(x(4)))*sin(conj(x(5)))^2), cos(conj(x(4)))*sin(conj(x(6)))*(ba2 + na2 - p2) - (cos(conj(x(6)))*sin(conj(x(5))) + cos(conj(x(5)))*sin(conj(x(4)))*sin(conj(x(6))))*(ba3 + na3 - p3) - (cos(conj(x(5)))*cos(conj(x(6))) - sin(conj(x(4)))*sin(conj(x(5)))*sin(conj(x(6))))*(ba1 + na1 - p1), - (cos(conj(x(5)))*sin(conj(x(6))) + cos(conj(x(6)))*sin(conj(x(4)))*sin(conj(x(5))))*(ba1 + na1 - p1) - (sin(conj(x(5)))*sin(conj(x(6))) - cos(conj(x(5)))*cos(conj(x(6)))*sin(conj(x(4))))*(ba3 + na3 - p3) - cos(conj(x(4)))*cos(conj(x(6)))*(ba2 + na2 - p2), cos(conj(x(4)))*sin(conj(x(5)))*(ba1 + na1 - p1) - cos(conj(x(4)))*cos(conj(x(5)))*(ba3 + na3 - p3) - sin(conj(x(4)))*(ba2 + na2 - p2) + 49/5, nbg1, nbg2, nbg3, nba1, nba2, nba3];


F(1,:) = [ 1, 0, 0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                        0,                                                                                                                                                                                                                                            0, dt,  0,  0,                                                                                                 0,   0,                                                                                                0,                                                                             0,                               0,                                                                             0];
F(2,:) = [ 0, 1, 0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                        0,                                                                                                                                                                                                                                            0,  0, dt,  0,                                                                                                 0,   0,                                                                                                0,                                                                             0,                               0,                                                                             0];
F(3,:) = [ 0, 0, 1,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                        0,                                                                                                                                                                                                                                            0,  0,  0, dt,                                                                                                 0,   0,                                                                                                0,                                                                             0,                               0,                                                                             0];
F(4,:) = [ 0, 0, 0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          1,                                                                                        -dt*((cos(conj(x(5)))*(bg3 + ng3 - q3))/(cos(conj(x(5)))^2 + sin(conj(x(5)))^2) - (sin(conj(x(5)))*(bg1 + ng1 - q1))/(cos(conj(x(5)))^2 + sin(conj(x(5)))^2)),                                                                                                                                                                                                                                            0,  0,  0,  0,                                           -(dt*cos(conj(x(5))))/(cos(conj(x(5)))^2 + sin(conj(x(5)))^2),   0,                                          -(dt*sin(conj(x(5))))/(cos(conj(x(5)))^2 + sin(conj(x(5)))^2),                                                                             0,                               0,                                                                             0];
F(5,:) = [ 0, 0, 0, dt*((cos(conj(x(4)))*cos(conj(x(5)))*(bg3 + ng3 - q3))/(cos(conj(x(4)))*cos(conj(x(5)))^2 + cos(conj(x(4)))*sin(conj(x(5)))^2) - (cos(conj(x(4)))*sin(conj(x(5)))*(bg1 + ng1 - q1))/(cos(conj(x(4)))*cos(conj(x(5)))^2 + cos(conj(x(4)))*sin(conj(x(5)))^2) + (cos(conj(x(5)))*sin(conj(x(4)))*(sin(conj(x(4)))*cos(conj(x(5)))^2 + sin(conj(x(4)))*sin(conj(x(5)))^2)*(bg3 + ng3 - q3))/(cos(conj(x(4)))*cos(conj(x(5)))^2 + cos(conj(x(4)))*sin(conj(x(5)))^2)^2 - (sin(conj(x(4)))*sin(conj(x(5)))*(sin(conj(x(4)))*cos(conj(x(5)))^2 + sin(conj(x(4)))*sin(conj(x(5)))^2)*(bg1 + ng1 - q1))/(cos(conj(x(4)))*cos(conj(x(5)))^2 + cos(conj(x(4)))*sin(conj(x(5)))^2)^2), 1 - dt*((cos(conj(x(5)))*sin(conj(x(4)))*(bg1 + ng1 - q1))/(cos(conj(x(4)))*cos(conj(x(5)))^2 + cos(conj(x(4)))*sin(conj(x(5)))^2) + (sin(conj(x(4)))*sin(conj(x(5)))*(bg3 + ng3 - q3))/(cos(conj(x(4)))*cos(conj(x(5)))^2 + cos(conj(x(4)))*sin(conj(x(5)))^2)),                                                                                                                                                                                                                                            0,  0,  0,  0, -(dt*sin(conj(x(4)))*sin(conj(x(5))))/(cos(conj(x(4)))*cos(conj(x(5)))^2 + cos(conj(x(4)))*sin(conj(x(5)))^2), -dt, (dt*cos(conj(x(5)))*sin(conj(x(4))))/(cos(conj(x(4)))*cos(conj(x(5)))^2 + cos(conj(x(4)))*sin(conj(x(5)))^2),                                                                             0,                               0,                                                                             0];
F(6,:) = [ 0, 0, 0,                                                                                                                                                                                                                                                              -dt*((cos(conj(x(5)))*(sin(conj(x(4)))*cos(conj(x(5)))^2 + sin(conj(x(4)))*sin(conj(x(5)))^2)*(bg3 + ng3 - q3))/(cos(conj(x(4)))*cos(conj(x(5)))^2 + cos(conj(x(4)))*sin(conj(x(5)))^2)^2 - (sin(conj(x(5)))*(sin(conj(x(4)))*cos(conj(x(5)))^2 + sin(conj(x(4)))*sin(conj(x(5)))^2)*(bg1 + ng1 - q1))/(cos(conj(x(4)))*cos(conj(x(5)))^2 + cos(conj(x(4)))*sin(conj(x(5)))^2)^2),                                 dt*((cos(conj(x(5)))*(bg1 + ng1 - q1))/(cos(conj(x(4)))*cos(conj(x(5)))^2 + cos(conj(x(4)))*sin(conj(x(5)))^2) + (sin(conj(x(5)))*(bg3 + ng3 - q3))/(cos(conj(x(4)))*cos(conj(x(5)))^2 + cos(conj(x(4)))*sin(conj(x(5)))^2)),                                                                                                                                                                                                                                            1,  0,  0,  0,                (dt*sin(conj(x(5))))/(cos(conj(x(4)))*cos(conj(x(5)))^2 + cos(conj(x(4)))*sin(conj(x(5)))^2),   0,              -(dt*cos(conj(x(5))))/(cos(conj(x(4)))*cos(conj(x(5)))^2 + cos(conj(x(4)))*sin(conj(x(5)))^2),                                                                             0,                               0,                                                                             0];
F(7,:) = [ 0, 0, 0,                                                                                                                                                                                                                                                                                                                                                                                                                               -dt*(sin(conj(x(4)))*sin(conj(x(6)))*(ba2 + na2 - p2) + cos(conj(x(4)))*cos(conj(x(5)))*sin(conj(x(6)))*(ba3 + na3 - p3) - cos(conj(x(4)))*sin(conj(x(5)))*sin(conj(x(6)))*(ba1 + na1 - p1)),                                             dt*((cos(conj(x(6)))*sin(conj(x(5))) + cos(conj(x(5)))*sin(conj(x(4)))*sin(conj(x(6))))*(ba1 + na1 - p1) - (cos(conj(x(5)))*cos(conj(x(6))) - sin(conj(x(4)))*sin(conj(x(5)))*sin(conj(x(6))))*(ba3 + na3 - p3)),  dt*((cos(conj(x(5)))*sin(conj(x(6))) + cos(conj(x(6)))*sin(conj(x(4)))*sin(conj(x(5))))*(ba1 + na1 - p1) + (sin(conj(x(5)))*sin(conj(x(6))) - cos(conj(x(5)))*cos(conj(x(6)))*sin(conj(x(4))))*(ba3 + na3 - p3) + cos(conj(x(4)))*cos(conj(x(6)))*(ba2 + na2 - p2)),  1,  0,  0,                                                                                                 0,   0,                                                                                                0, -dt*(cos(conj(x(5)))*cos(conj(x(6))) - sin(conj(x(4)))*sin(conj(x(5)))*sin(conj(x(6)))),  dt*cos(conj(x(4)))*sin(conj(x(6))), -dt*(cos(conj(x(6)))*sin(conj(x(5))) + cos(conj(x(5)))*sin(conj(x(4)))*sin(conj(x(6))))];
F(8,:) = [ 0, 0, 0,                                                                                                                                                                                                                                                                                                                                                                                                                                dt*(cos(conj(x(6)))*sin(conj(x(4)))*(ba2 + na2 - p2) + cos(conj(x(4)))*cos(conj(x(5)))*cos(conj(x(6)))*(ba3 + na3 - p3) - cos(conj(x(4)))*cos(conj(x(6)))*sin(conj(x(5)))*(ba1 + na1 - p1)),                                             dt*((sin(conj(x(5)))*sin(conj(x(6))) - cos(conj(x(5)))*cos(conj(x(6)))*sin(conj(x(4))))*(ba1 + na1 - p1) - (cos(conj(x(5)))*sin(conj(x(6))) + cos(conj(x(6)))*sin(conj(x(4)))*sin(conj(x(5))))*(ba3 + na3 - p3)), -dt*((cos(conj(x(5)))*cos(conj(x(6))) - sin(conj(x(4)))*sin(conj(x(5)))*sin(conj(x(6))))*(ba1 + na1 - p1) + (cos(conj(x(6)))*sin(conj(x(5))) + cos(conj(x(5)))*sin(conj(x(4)))*sin(conj(x(6))))*(ba3 + na3 - p3) - cos(conj(x(4)))*sin(conj(x(6)))*(ba2 + na2 - p2)),  0,  1,  0,                                                                                                 0,   0,                                                                                                0, -dt*(cos(conj(x(5)))*sin(conj(x(6))) + cos(conj(x(6)))*sin(conj(x(4)))*sin(conj(x(5)))), -dt*cos(conj(x(4)))*cos(conj(x(6))), -dt*(sin(conj(x(5)))*sin(conj(x(6))) - cos(conj(x(5)))*cos(conj(x(6)))*sin(conj(x(4))))];
F(9,:) = [ 0, 0, 0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                         -dt*(cos(conj(x(4)))*(ba2 + na2 - p2) - cos(conj(x(5)))*sin(conj(x(4)))*(ba3 + na3 - p3) + sin(conj(x(4)))*sin(conj(x(5)))*(ba1 + na1 - p1)),                                                                                                                                         dt*(cos(conj(x(4)))*cos(conj(x(5)))*(ba1 + na1 - p1) + cos(conj(x(4)))*sin(conj(x(5)))*(ba3 + na3 - p3)),                                                                                                                                                                                                                                            0,  0,  0,  1,                                                                                                 0,   0,                                                                                                0,                                                dt*cos(conj(x(4)))*sin(conj(x(5))),               -dt*sin(conj(x(4))),                                               -dt*cos(conj(x(4)))*cos(conj(x(5)))];
F(10,:) = [ 0, 0, 0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                        0,                                                                                                                                                                                                                                            0,  0,  0,  0,                                                                                                 1,   0,                                                                                                0,                                                                             0,                               0,                                                                             0];
F(11,:) = [ 0, 0, 0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                        0,                                                                                                                                                                                                                                            0,  0,  0,  0,                                                                                                 0,   1,                                                                                                0,                                                                             0,                               0,                                                                             0];
F(12,:) = [ 0, 0, 0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                        0,                                                                                                                                                                                                                                            0,  0,  0,  0,                                                                                                 0,   0,                                                                                                1,                                                                             0,                               0,                                                                             0];
F(13,:) = [ 0, 0, 0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                        0,                                                                                                                                                                                                                                            0,  0,  0,  0,                                                                                                 0,   0,                                                                                                0,                                                                             1,                               0,                                                                             0];
F(14,:) = [ 0, 0, 0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                        0,                                                                                                                                                                                                                                            0,  0,  0,  0,                                                                                                 0,   0,                                                                                                0,                                                                             0,                               1,                                                                             0];
F(15,:) = [ 0, 0, 0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                        0,                                                                                                                                                                                                                                            0,  0,  0,  0,                                                                                                 0,   0,                                                                                                0,                                                                             0,                               0,                                                                             1];
 




V_t(1,:) = [                                                                             0,                               0,                                                                             0,                                                                                                 0,   0,                                                                                                0,  0,  0,  0,  0,  0,  0];
V_t(2,:) = [                                                                             0,                               0,                                                                             0,                                                                                                 0,   0,                                                                                                0,  0,  0,  0,  0,  0,  0];
V_t(3,:) = [                                                                             0,                               0,                                                                             0,                                                                                                 0,   0,                                                                                                0,  0,  0,  0,  0,  0,  0];
V_t(4,:) = [                                                                             0,                               0,                                                                             0,                                           -(dt*cos(conj(x(5))))/(cos(conj(x(5)))^2 + sin(conj(x(5)))^2),   0,                                          -(dt*sin(conj(x(5))))/(cos(conj(x(5)))^2 + sin(conj(x(5)))^2),  0,  0,  0,  0,  0,  0];
V_t(5,:) = [                                                                             0,                               0,                                                                             0, -(dt*sin(conj(x(4)))*sin(conj(x(5))))/(cos(conj(x(4)))*cos(conj(x(5)))^2 + cos(conj(x(4)))*sin(conj(x(5)))^2), -dt, (dt*cos(conj(x(5)))*sin(conj(x(4))))/(cos(conj(x(4)))*cos(conj(x(5)))^2 + cos(conj(x(4)))*sin(conj(x(5)))^2),  0,  0,  0,  0,  0,  0];
V_t(6,:) = [                                                                             0,                               0,                                                                             0,                (dt*sin(conj(x(5))))/(cos(conj(x(4)))*cos(conj(x(5)))^2 + cos(conj(x(4)))*sin(conj(x(5)))^2),   0,              -(dt*cos(conj(x(5))))/(cos(conj(x(4)))*cos(conj(x(5)))^2 + cos(conj(x(4)))*sin(conj(x(5)))^2),  0,  0,  0,  0,  0,  0];
V_t(7,:) = [ -dt*(cos(conj(x(5)))*cos(conj(x(6))) - sin(conj(x(4)))*sin(conj(x(5)))*sin(conj(x(6)))),  dt*cos(conj(x(4)))*sin(conj(x(6))), -dt*(cos(conj(x(6)))*sin(conj(x(5))) + cos(conj(x(5)))*sin(conj(x(4)))*sin(conj(x(6)))),                                                                                                 0,   0,                                                                                                0,  0,  0,  0,  0,  0,  0];
V_t(8,:) = [ -dt*(cos(conj(x(5)))*sin(conj(x(6))) + cos(conj(x(6)))*sin(conj(x(4)))*sin(conj(x(5)))), -dt*cos(conj(x(4)))*cos(conj(x(6))), -dt*(sin(conj(x(5)))*sin(conj(x(6))) - cos(conj(x(5)))*cos(conj(x(6)))*sin(conj(x(4)))),                                                                                                 0,   0,                                                                                                0,  0,  0,  0,  0,  0,  0];
V_t(9,:) = [                                                dt*cos(conj(x(4)))*sin(conj(x(5))),               -dt*sin(conj(x(4))),                                               -dt*cos(conj(x(4)))*cos(conj(x(5))),                                                                                                 0,   0,                                                                                                0,  0,  0,  0,  0,  0,  0];
V_t(10,:) = [                                                                             0,                               0,                                                                             0,                                                                                                 0,   0,                                                                                                0, dt,  0,  0,  0,  0,  0];
V_t(11,:) = [                                                                             0,                               0,                                                                             0,                                                                                                 0,   0,                                                                                                0,  0, dt,  0,  0,  0,  0];
V_t(12,:) = [                                                                             0,                               0,                                                                             0,                                                                                                 0,   0,                                                                                                0,  0,  0, dt,  0,  0,  0];
V_t(13,:) = [                                                                             0,                               0,                                                                             0,                                                                                                 0,   0,                                                                                                0,  0,  0,  0, dt,  0,  0];
V_t(14,:) = [                                                                             0,                               0,                                                                             0,                                                                                                 0,   0,                                                                                                0,  0,  0,  0,  0, dt,  0];
V_t(15,:) = [                                                                             0,                               0,                                                                             0,                                                                                                 0,   0,                                                                                                0,  0,  0,  0,  0,  0, dt];
 